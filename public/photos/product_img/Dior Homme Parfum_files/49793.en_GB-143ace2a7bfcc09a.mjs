(self.modernJsonp=self.modernJsonp||[]).push([["49793"],{625957:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FlashlightSpotlightDots_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetStringifiedCommerceAuxData_pin"}],type:"Pin",abstractKey:null};i.hash="3a8409077905af94eb39568e4a5a57fc";let a=i},703555:function(e,t,n){n.r(t),n.d(t,{default:()=>a});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaCutout_pin",selections:[{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};i.hash="0b66eea622c037ef845cce3aa4cd2d46";let a=i},101844:function(e,t,n){n.d(t,{Z:()=>p});var i=n(281098),a=n(667294),o=n(20256),r=n(785893);let s={nw_horizontal:"inset(0 0 0 50%)",nw_vertical:"inset(50% 0 0 0)",ne_horizontal:"inset(0 50% 0 0)",ne_vertical:"inset(50% 0 0 0)",sw_horizontal:"inset(0 0 0 50%)",sw_vertical:"inset(0 0 50% 0)",se_horizontal:"inset(0 50% 0 0)",se_vertical:"inset(0 0 50% 0)"};function l({top:e,left:t,bottom:n,right:l,size:u,transition:c,opacity:h}){(0,a.useEffect)(()=>{(0,i.Z)("AnchorStrokeCap","/app/packages/Cropper/AnchorStrokeCap.tsx")},[]);let d=(0,a.useMemo)(()=>{let i=((e,t,n,i)=>{let a=void 0!==e,o=void 0!==n,r=void 0!==t,s=void 0!==i;return a&&r&&!o&&!s?"nw":a&&s&&!o&&!r?"ne":o&&r&&!a&&!s?"sw":o&&s&&!a&&!r?"se":"none"})(e,t,n,l),a=0===e||0===n?"horizontal":0===t||0===l?"vertical":"none";return`${i}_${a}`},[e,t,n,l]),p=s[d]||"none";return(0,r.jsx)(o.xu,{color:"default",dangerouslySetInlineStyle:{__style:{top:e,left:t,right:l,bottom:n,clipPath:p,transition:c,opacity:h}},"data-test-id":d,height:u,position:"absolute",rounding:"circle",width:u})}var u=n(642407);function c({anchorSize:e,corner:t,maxTouchSize:n}){(0,a.useEffect)(()=>{(0,i.Z)("AnchorTouchArea","/app/packages/Cropper/AnchorTouchArea.tsx")},[]);let s=u.FA[t],l=`${u.tT} ${t}`,c=Math.min(u.e4*u.MS,n),h=(c-e)/2,d=t.includes("n")?-h:void 0,p=t.includes("w")?-h:void 0,f=t.includes("s")?-h:void 0,x=t.includes("e")?-h:void 0;return(0,r.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{top:d,left:p,bottom:f,right:x,cursor:s,pointerEvents:"auto"}},"data-test-id":`cropper-corner-${t}`,height:c,id:l,position:"absolute",width:c})}var h=n(462404);let d=({x:e,y:t,size:n})=>`linear-gradient(black, black) ${e}px ${t}px / ${n}px ${n}px no-repeat`;function p({anchorSelection:e,h:t,handleCount:n,size:s,transition:p,visibility:f,w:x,x:y,y:m}){(0,a.useEffect)(()=>{(0,i.Z)("CropperAnchors","/app/packages/Cropper/CropperAnchors.tsx")},[]);let g=2===n,v=g?u.jf:u.m6,w=g?u.O3:u.ps,S=s/2,b=u.e4/2-u.xh-w-u.eq+(0,h.Z)({w:x,h:t,minSize:u.eq,maxSize:0}),_=x+2*S-2*b,k=t+2*S-2*b,j=u.e4-s,M=Math.max(u.CT-j,u.AL),z=u.xh/2,$=s-z,Z=$-z,E=(Math.min(_,k)-u.dH)/2,C="ne"===e?1:v,P=d({x:_-$,y:0,size:$}),I="nw"===e?1:v,F=d({x:0,y:0,size:$}),A="sw"===e?1:v,T=d({x:0,y:k-$,size:$}),R="se"===e?1:v,D=d({x:_-$,y:k-$,size:$});return(0,r.jsxs)(o.xu,{dangerouslySetInlineStyle:{__style:{top:m-S+b,left:y-S+b,pointerEvents:"none",visibility:f,transition:p}},height:k,position:"absolute",width:_,children:[(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${M}px`,mask:P,pointerEvents:"none",transition:p,opacity:C}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{opacity:C,right:0,size:u.xh,top:Z,transition:p}),(0,r.jsx)(l,{opacity:C,right:Z,size:u.xh,top:0,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"ne",maxTouchSize:E}),(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${M}px`,mask:T,pointerEvents:"none",transition:p,opacity:A}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{bottom:0,left:Z,opacity:A,size:u.xh,transition:p}),(0,r.jsx)(l,{bottom:Z,left:0,opacity:A,size:u.xh,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"sw",maxTouchSize:E}),!g&&(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${M}px`,mask:F,pointerEvents:"none",transition:p,opacity:I}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{left:0,opacity:I,size:u.xh,top:Z,transition:p}),(0,r.jsx)(l,{left:Z,opacity:I,size:u.xh,top:0,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"nw",maxTouchSize:E}),(0,r.jsx)(o.xu,{color:"transparent",dangerouslySetInlineStyle:{__style:{border:`${u.xh}px solid white`,borderRadius:`${M}px`,mask:D,pointerEvents:"none",transition:p,opacity:R}},height:"100%",left:!0,position:"absolute",top:!0,width:"100%"}),(0,r.jsx)(l,{bottom:0,opacity:R,right:Z,size:u.xh,transition:p}),(0,r.jsx)(l,{bottom:Z,opacity:R,right:0,size:u.xh,transition:p}),(0,r.jsx)(c,{anchorSize:s,corner:"se",maxTouchSize:E})]})]})}},442212:function(e,t,n){n.d(t,{Z:()=>g});var i=n(281098),a=n(667294),o=n(20256),r=n(521009),s=n(642407),l=n(101844),u=n(740787),c=n(598600),h=n(826972),d=n(462404),p=n(503246),f=n(187356),x=n(675973),y=n(378547),m=n(785893);function g({children:e,cropArea:{x:t,y:n,w:g,h:v},cropSource:w,hoveredCutoutIndex:S,imageContainerX:b,imageContainerY:_,imageSize:{width:k=1,height:j=1},objectDetection:M,onChange:z,setHoveredCutoutIndex:$,setSelectedCutoutIndex:Z,viewParameter:E,viewType:C}){(0,a.useEffect)(()=>{(0,i.Z)("CropperV2","/app/packages/Cropper/CropperV2.tsx")},[]);let{checkExperiment:P}=(0,x.Z)(),I=(0,r.Z)(),F=(0,a.useRef)(null),A=(0,a.useMemo)(()=>({x:0,y:0,w:k,h:j}),[j,k]),T=(0,a.useMemo)(()=>(0,c.Z)({cropArea:{x:t,y:n,w:g,h:v},imageSize:{width:k,height:j}}),[v,g,t,n,j,k]),[R,D]=(0,a.useState)(()=>(0,p.ZP)({x:t,y:n,w:g,h:v},A)?A:T),L=(0,a.useMemo)(()=>(0,p.ZP)(R,A),[R,A]),[W,K]=(0,a.useState)("none"),[O,H]=(0,a.useState)("none"),[q,G]=(0,a.useState)(!1),[V,B]=(0,a.useState)(!1),[X,J]=(0,a.useState)(!1),[N,U]=(0,a.useState)(0),[Y,Q]=(0,a.useState)(0),{anyEnabled:ee,group:et}=P("web_cropper_object_selection"),{x:en,y:ei,w:ea,h:eo}=R,er=(0,a.useMemo)(()=>(0,d.Z)({w:ea,h:eo,minSize:s.Zn,maxSize:s.e4}),[eo,ea]),es=s.e4-er,el=ee?s.O3:s.ps,eu=s.Y4-er,ec=s.SP,eh=s.SP,ed=k-s.SP,ep=j-s.SP,ef="number"==typeof S,ex=V?"none":"0.3s cubic-bezier(0.42, 0, 0.58, 1.2)",ey=(0,u.Z)({cropperSelection:W,anchorSelection:O,hasMouseMoved:V}),em=ee?function({cropperSelection:e,isTargetOnObject:t,cropSource:n,hasClickedOnObject:i,experimentGroup:a}){return("none"===e||t)&&(9===n||i)?"enabled_dark"===a?s.pg:s.z3:0}({cropperSelection:W,isTargetOnObject:q,cropSource:w,hasClickedOnObject:X,experimentGroup:et}):0,eg=e=>{e.preventDefault();let{clientX:t,clientY:n,target:i}=e,a=t-b,o=n-_;B(!1),J(!1),U(a),Q(o);let{id:r}=i,[l,u="none"]=r.split(" "),c=`${l}`===s.tT,h=r===s.at,d=r===s.eX,p=r===f.P,x=r===y.I;c?(K("anchor"),H(u)):d?K("cropbox"):h?K("background"):(!(en<a&&a<en+ea&&ei<o&&o<ei+eo)||L?K("background"):K("cropbox"),G(p||x))},ev=e=>{if("none"===W)return;let{clientX:t,clientY:n}=e,i=t-b,a=n-_;if(!(Math.abs(i-N)<s.yG&&Math.abs(a-Y)<s.yG&&!V&&["cropbox","background"].includes(W)))switch(B(!0),G(!1),$?.(null),Z?.(-1),W){case"anchor":{let e=["nw","sw"].includes(O),t=["nw","ne"].includes(O),n=Math.max(Math.min(i,ed),ec),o=Math.max(Math.min(a,ep),eh),r=e?Math.min(n,en+ea-s.yz):en;D({x:r,y:t?Math.min(o,ei+eo-s.yz):ei,w:e?Math.max(en+ea-n,s.yz):Math.max(n-en,s.yz),h:t?Math.max(ei+eo-o,s.yz):Math.max(o-ei,s.yz)});break}case"cropbox":{let e=Math.max(Math.min(en+(i-N),k-ea-ec),ec),t=Math.max(Math.min(ei+(a-Y),j-eo-eh),eh);U(i),Q(a),D({x:e,y:t,w:ea,h:eo});break}case"background":{let e=Math.max(Math.min(i,k),0),t=Math.max(Math.min(a,j),0),n=e-N,o=t-Y;D({x:Math.min(N,e),y:Math.min(Y,t),w:Math.abs(n),h:Math.abs(o)})}}},ew=()=>{if(K("none"),H("none"),G(!1),B(!1),"none"===W)return;if(q&&("cutouts"===M&&ef||"dots"===M))return void J(!0);let e=(e,t)=>{z({cropArea:e,cropSource:t}),D(e)};if(V){let t=Math.max(Math.min(en,k-s.yz-ec),ec),n=Math.max(Math.min(ei,j-s.yz-eh),eh),i=eo<s.yz?s.yz:n+eo>j-eh?j-n-eh:eo,a=ea<s.yz?s.yz:t+ea>k-ec?k-t-ec:ea;e({x:t,y:n,w:a,h:i},6),"cropbox"===W?I({event_type:7603,view_type:C,view_parameter:E}):"anchor"===W?I({event_type:7604,view_type:C,view_parameter:E}):"background"===W&&I({event_type:16584,view_type:C,view_parameter:E})}else L||"background"===W?(e((0,h.Z)({mouseX:N,mouseY:Y,cropSize:s.Rk,minBound:s.SP,imageWidth:k,imageHeight:j}),6),I({event_type:16585,view_type:C,view_parameter:E})):"cropbox"===W&&(e(A,5),I({event_type:16586,view_type:C,view_parameter:E}))};return(0,a.useEffect)(()=>{X&&D(T)},[T,X]),(0,a.useEffect)(()=>{let e=F.current;return e?.addEventListener("mousedown",eg),window.addEventListener("mousemove",ev),window.addEventListener("mouseup",ew),()=>{e?.removeEventListener("mousedown",eg),window.removeEventListener("mousemove",ev),window.removeEventListener("mouseup",ew)}}),(0,m.jsxs)(o.xu,{ref:F,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:ey}},"data-test-id":"visual-search-cropper",left:!0,position:"absolute",right:!0,top:!0,children:[(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{border:`${el}px solid rgba(255, 255, 255, 0.20)`,borderRadius:`${eu}px`,boxShadow:"0 0 0 99999px rgba(0, 0, 0, 0.35)",left:en,top:ei,transition:ex,backgroundColor:`rgba(0, 0, 0, ${em})`}},height:eo,position:"absolute",width:ea}),(0,m.jsx)(o.xu,{bottom:!0,id:s.at,left:!0,position:"absolute",right:!0,top:!0}),(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{visibility:L?"hidden":"visible",left:en,top:ei}},"data-test-id":"cropper-section",height:eo,id:s.eX,position:"absolute",width:ea}),e,(0,m.jsx)(l.Z,{anchorSelection:O,h:eo,handleCount:ee?2:4,size:es,transition:ex,visibility:L||"background"===W&&V?"hidden":"visible",w:ea,x:en,y:ei})]})}},740787:function(e,t,n){n.d(t,{Z:()=>i});function i({cropperSelection:e,anchorSelection:t,hasMouseMoved:n}){if("background"===e&&n)return"crosshair";if("cropbox"===e&&n)return"move";if("anchor"===e){if("nw"===t||"se"===t)return"nwse-resize";else if("ne"===t||"sw"===t)return"nesw-resize"}return"auto"}},598600:function(e,t,n){n.d(t,{Z:()=>a});var i=n(642407);function a({cropArea:e,imageSize:t}){let{x:n,y:a,w:o,h:r}=e,{height:s,width:l}=t;if(!s||!l)return e;let u=n,c=a,h=o,d=r;return u<i.SP&&(u=i.SP,h-=i.SP-n),u+h>l-i.SP&&(h-=u+h-l+i.SP),c<i.SP&&(c=i.SP,d-=i.SP-a),c+d>s-i.SP&&(d-=c+d-s+i.SP),{x:u,y:c,w:h,h:d}}},826972:function(e,t,n){n.d(t,{Z:()=>a});let i=({coordinate:e,cropSize:t,maxBound:n,minBound:i})=>e<=i?i:n<=e+t?n-t:e;function a({cropSize:e,imageHeight:t,imageWidth:n,minBound:a,mouseX:o,mouseY:r}){let s=o-e/2,l=r-e/2,u=n-a,c=t-a;return{x:i({coordinate:s,minBound:a,maxBound:u,cropSize:e}),y:i({coordinate:l,minBound:a,maxBound:c,cropSize:e}),w:e,h:e}}},462404:function(e,t,n){n.d(t,{Z:()=>a});var i=n(642407);function a({w:e,h:t,minSize:n,maxSize:a}){let o=Math.min(e,t);return o<=i.yz?a-n:o<i.Kw?(a-n)/(i.Kw-i.yz)*(i.Kw-o):0}},187356:function(e,t,n){n.d(t,{P:()=>s,Z:()=>c});var i=n(667294),a=n(20256),o=n(19585),r=n(785893);let s="flashlight-dot-style",l=16,u=32,c=(0,i.forwardRef)(({icon:e,onClick:t,onMouseDown:n,onMouseEnter:c,onMouseLeave:h,onMouseUp:d,selected:p,style:f,text:x,x:y,y:m,zIndex:g,backdropDiameter:v=u,dotDiameter:w=l},S)=>{let[b,_]=(0,i.useState)(!1),k=(0,o.ZP)(),j=b?v+4:v;return(0,r.jsx)(a.xu,{ref:S,dangerouslySetInlineStyle:{__style:{top:m-j/2,left:y-j/2,outline:"none"}},position:"absolute",zIndex:new a.Ry(g||0),children:(0,r.jsx)(a.iP,{accessibilityLabel:k.bt("Search for this item", "Search this item", "flashlight.dot.a11ylabel", undefined, true),dataTestId:"flashlight-dot",onMouseDown:n,onMouseEnter:({event:e})=>{_(!0),c?.({event:e})},onMouseLeave:({event:e})=>{_(!1),h?.({event:e})},onMouseUp:d,onTap:t,tabIndex:0,children:(0,r.jsxs)(a.xu,{alignItems:"center",borderStyle:"none",color:"default",dangerouslySetInlineStyle:{__style:{boxShadow:p?"0 0 0 3px #e60023":"none",borderRadius:w,top:(j-w)/2,left:(j-w)/2,...f}},"data-test-id":s,display:"flex",height:w,id:s,justifyContent:"center",padding:0,position:"absolute",width:w,children:[!!x&&(0,r.jsx)(a.xv,{align:"center",color:"default",inline:!0,size:"100",weight:"bold",children:x}),e&&(0,r.jsx)(a.JO,{accessibilityLabel:k.bt("Tag anchor", "Tag anchor", "accessibility label for an anchor for an object in a pin", undefined, true),color:"error",icon:e,inline:!0,size:w/2})]})})})})},941023:function(e,t,n){n.d(t,{Z:()=>m});var i,a=n(281098),o=n(667294);n(167912);var r=n(521009),s=n(187356),l=n(341742),u=n(785893);function c({showAnimation:e,auxData:t,index:n,isStela:i,onClick:c,onHover:h,onUnhover:d,spotlightCenter:p,viewParameter:f,viewType:x}){(0,o.useEffect)(()=>{(0,a.Z)("FlashlightSpotlightDot","/app/packages/Flashlight/FlashlightSpotlightDot.tsx")},[]);let y=(0,r.Z)(),m=i?1221:1260;(0,l.Z)(()=>{y({event_type:120,element:m,aux_data:t,view_parameter:f,view_type:x})});let g=parseFloat((.1*(n+1)).toFixed(2)),v={animation:e?`spotlightDotPop 0.6s ease-out ${g}s both`:"none"};return(0,u.jsx)(s.Z,{onClick:()=>{y({aux_data:t,element:m,event_type:101,view_parameter:f,view_type:x}),c(n)},onMouseEnter:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),h?.(n)},onMouseLeave:({event:e})=>{e&&(e.stopPropagation(),e.preventDefault()),d?.()},style:v,x:p.x,y:p.y})}var h=n(28427),d=n(369416),p=n(431338),f=n(556872);let x=`
@keyframes spotlightDotPop {
  0% {
    transform: scale(0);
  }

  100% {
    transform: scale(1);
  }
}`,y=(void 0!==i||(i=n(625957)).hash&&"3a8409077905af94eb39568e4a5a57fc"!==i.hash&&console.error("The definition of 'FlashlightSpotlightDots_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),m=({showAnimation:e,pinKey:t,imageSignature:n,imageSize:i,currentSpotlightIdx:r,handleSpotlightClick:s,handleSpotlightHover:l,handleSpotlightUnhover:m,viewParameter:g,viewType:v,visualObjects:w})=>{(0,o.useEffect)(()=>{(0,a.Z)("FlashlightSpotlightDots","/app/packages/Flashlight/FlashlightSpotlightDots.tsx")},[]);let S=(0,h.Z)(y,t),b=(0,p.Z)(S),_=S?(S.visualObjects??[]).filter(e=>e.isStela):w??[];return(0,u.jsxs)(o.Fragment,{children:[(0,u.jsx)(d.Z,{unsafeCSS:x}),_.map((t,a)=>{if(a===r)return null;let{x:o,y:h,w:d,h:p}=t,x=(0,f.Z)({cropArea:{x:o,y:h,w:d,h:p},scaledWidth:i.width??0,scaledHeight:i.height??0}),y={x:x.x+x.w/2,y:x.y+x.h/2},w={...b({override:{entrypoint:"flashlight"}}),pin_id:S?.entityId??"",image_signature:n,visual_objects:JSON.stringify([{x:t.x,y:t.y,w:t.w,h:t.h}])},_=`${y.x}${y.y}`;return(0,u.jsx)(c,{auxData:w,index:a,isStela:!!t?.isStela,onClick:s,onHover:l,onUnhover:m,showAnimation:e,spotlightCenter:y,viewParameter:g,viewType:v},_)})]})}},74678:function(e,t,n){n.d(t,{Z:()=>i});function i({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:a,scaledHeight:o}){return{x:e/a,y:t/o,w:n/a,h:i/o}}},556872:function(e,t,n){n.d(t,{Z:()=>i});function i({cropArea:e,scaledWidth:t,scaledHeight:n}){let i=e.h||0;return{h:Math.floor(i*n),w:Math.floor((e.w||0)*t),x:Math.floor((e.x||0)*t),y:Math.floor((e.y||0)*n)}}},854146:function(e,t,n){n.d(t,{Z:()=>h});var i=n(281098),a=n(667294),o=n(633301),r=n(20256),s=n(675973),l=n(665290),u=n(281503),c=n(785893);function h({imageHeight:e,imageUrl:t,imageWidth:n,isHovered:h,isPinLevelCrop:d,isSelected:p,maskHeight:f,maskId:x,maskUrl:y,maskWidth:m,maskX:g,maskY:v}){(0,a.useEffect)(()=>{(0,i.Z)("CutoutOverlay","/app/www/Cutouts/CutoutOverlay.tsx")},[]);let{checkExperiment:w}=(0,s.Z)(),S=w("web_cropper_object_selection").anyEnabled,b=(0,a.useRef)(null),_=S?h||p:h,k=d&&h?1.2:1,{svgElement:j,maskStyle:M}=(0,u.Z)({maskUrl:y,maskWidth:m,maskHeight:f,maskId:x,kind:"overlay"});return(0,c.jsx)(o.Z,{appear:p,classNames:l.We,in:_,nodeRef:b,timeout:{appear:l.VI,enter:l.eZ,exit:l.eZ},children:(0,c.jsxs)(r.xu,{ref:b,dangerouslySetInlineStyle:{__style:{left:g,top:v,...M,pointerEvents:"none",filter:`brightness(${k})`}},height:f,opacity:0,overflow:"hidden",position:"absolute",width:m,children:[j,(0,c.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{transform:`translate(-${g}px, -${v}px)`}},height:e,width:n,children:(0,c.jsx)(r.Ee,{alt:"cutout-overlay-image",color:"transparent",fit:"cover",naturalHeight:e,naturalWidth:n,src:t})})]})})}},378547:function(e,t,n){n.d(t,{Z:()=>v,I:()=>m});var i,a=n(281098),o=n(667294);n(167912);var r=n(825332),s=n(20256),l=n(980787),u=n(642407),c=n(28427),h=n(728994),d=n(854146);function p({contour:e,context:t,contourXRatio:n,contourYRatio:i}){t.beginPath(),e.points.forEach((e,a)=>{if(e){let o=e.x*n,r=e.y*i;0===a?t.moveTo(o,r):t.lineTo(o,r)}})}var f=n(814685),x=n(330510),y=n(785893);let m="stela-cutout",g=(void 0!==i||(i=n(703555)).hash&&"0b66eea622c037ef845cce3aa4cd2d46"!==i.hash&&console.error("The definition of 'StelaCutout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function v({auxData:e,bitmapData:t,hasAnimatedCutoutsOnLand:n,hasLoggedRender:i,hoveredCutoutIndex:v,index:w,isPinLevelCrop:S,pinImageHovered:b,pinKey:_,selectedCutoutIndex:k,setHasAnimatedCutoutsOnLand:j,setHasLoggedRender:M,viewParameter:z,viewType:$}){(0,o.useEffect)(()=>{(0,a.Z)("StelaCutout","/app/www/Cutouts/StelaCutout.tsx")},[]);let Z=(0,x.D)(),{logContextEvent:E}=(0,l.u)(),C=(0,r.TH)(),P=(0,c.Z)(g,_),{getNormalizedPinImage:I}=(0,h.Z)({pinKey:P,maxWidth:Z?f.M:u.Wm}),F=(0,o.useRef)(null),A=(0,o.useRef)(null),T=(0,o.useRef)(null),[R,D]=(0,o.useState)(0),[L,W]=(0,o.useState)(!1),[K,O]=(0,o.useState)(0),[H,q]=(0,o.useState)(!1),G=C.pathname.includes("visual-search"),{height:V,width:B,url:X}=I(),{contours:J,contourXRatio:N,contourYRatio:U,id:Y,isHidden:Q,maskHeightRatio:ee,maskUrl:et,maskWidthRatio:en,maskXRatio:ei,maskYRatio:ea}=t,eo=ei*B,er=ea*V,es=en*B,el=ee*V,eu=v===w,ec=k===w,eh=J&&J.length>0;(0,o.useEffect)(()=>{i||(E({event_type:120,element:14154,view_parameter:z,view_type:$,aux_data:e}),M?.(!0))},[e,i,E,M,z,$]),(0,o.useEffect)(()=>{F.current&&(F.current.width=es,F.current.height=el,A.current=new(window.OffscreenCanvas||window.HTMLCanvasElement)(es,el))},[es,el]);let ed=(0,o.useCallback)(()=>{q(!0)},[]);return(0,o.useEffect)(()=>{let e=F.current;return e?.addEventListener("transitionend",ed),()=>{e?.removeEventListener("transitionend",ed)}}),(0,o.useEffect)(()=>{if(!F.current||!A.current||!eh||!N||!U)return;let e=F.current.getContext("2d");return n?void e?.clearRect(0,0,F.current.width,F.current.height):((!H||b||Q&&eu)&&(T.current=requestAnimationFrame(()=>{if(!F.current||!A.current)return;let t=A.current.getContext("2d");e&&t&&(!function({contours:e,context:t,hasAnimatedCutoutsOnLand:n,hoveredCutoutIndex:i,index:a,isHidden:o,contourXRatio:r,contourYRatio:s,setTraceProgress:l,setHasAnimatedCutoutsOnLand:u,style:c,traceProgress:h,selectedCutoutIndex:d}){if(t.clearRect(0,0,t.canvas.width,t.canvas.height),!e||0===e.length||d===i&&i===a||d===a)return;let f={trace:{strokeStyle:"#fff",lineWidth:2},outline:{strokeStyle:"#fff",lineWidth:3}},x=o&&i===a,y=!o||x;if("trace"===c&&void 0!==h){let o=h,d=e[0].points.length;if(n){if(x||i===a){l(o=(o+900/((e,t,n)=>{let i=0;for(let a=0;a<e.length-1;a+=1){let o=e[a],r=e[a+1];if(o&&r){let e=(r.x-o.x)*t,a=(r.y-o.y)*n;i+=Math.sqrt(e*e+a*a)}}if(e.length>0){let a=e[0],o=e[e.length-1];if(a&&o){let e=(a.x-o.x)*t,r=(a.y-o.y)*n;i+=Math.sqrt(e*e+r*r)}}return i})(e[0].points,r,s)*3.2/1e3)%1);let n=Math.floor(.33*d),i=Math.floor(d*o),a=(i-n+d)%d;e.map(e=>({...e,points:a<i?e.points.slice(a,i):e.points.slice(a).concat(e.points.slice(0,i))})).forEach(e=>{e.points.length>1&&(t.strokeStyle=f[c].strokeStyle,p({contour:e,context:t,contourXRatio:r,contourYRatio:s}),y&&(t.lineWidth=f[c].lineWidth,t.stroke()))})}}else{let n,i;if(l(o+=o<=1?.0032:.009600000000000001),o>=2){l(1),u(!0);return}let a=Math.floor(.33*d);o<=1?i=((n=Math.floor(d*o))-a+d)%d:(n=d,i=Math.floor(d-a+a*(o-1))),e.map(e=>{let t=[];return t=i<n?e.points.slice(i,n):e.points.slice(i).concat(e.points.slice(0,n)),{...e,points:t}}).forEach(e=>{e.points.length>1&&(t.strokeStyle=f[c].strokeStyle,p({contour:e,context:t,contourXRatio:r,contourYRatio:s}),y&&(t.lineWidth=f[c].lineWidth,t.stroke()))})}}else e.forEach(e=>{p({contour:e,context:t,contourXRatio:r,contourYRatio:s}),y&&(t.strokeStyle=f[c].strokeStyle,t.lineWidth=f[c].lineWidth,t.stroke(),i===a&&(t.save(),t.fillStyle="rgba(255, 255, 255, 0.25)",t.fill(),t.restore()))})}({contours:J,context:t,contourXRatio:N,contourYRatio:U,index:w,isHidden:Q,hoveredCutoutIndex:v,opacity:R,setTraceProgress:O,hasAnimatedCutoutsOnLand:n,setHasAnimatedCutoutsOnLand:j,style:"trace",traceProgress:K,selectedCutoutIndex:k}),e.clearRect(0,0,F.current.width,F.current.height),e.drawImage(A.current,0,0))})),()=>{T.current&&(cancelAnimationFrame(T.current),T.current=null)})},[N,U,J,n,eh,v,w,H,Q,eu,R,b,k,j,K]),(0,o.useEffect)(()=>{if(b)W(!0),D(1);else if(L)D(0);else{D(1);let e=setTimeout(()=>{W(!1),D(0)},3e3);return()=>clearTimeout(e)}},[b,L,D]),(0,y.jsxs)(s.xu,{children:[(0,y.jsx)(d.Z,{imageHeight:V,imageUrl:X,imageWidth:B,isHovered:eu,isPinLevelCrop:S,isSelected:ec,maskHeight:el,maskId:Y,maskUrl:et,maskWidth:es,maskX:eo,maskY:er}),eh&&(0,y.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{top:er,left:eo}},height:el,position:"absolute",width:es,children:(0,y.jsx)("canvas",{ref:F,"data-test-id":"cutout-item",id:m,style:{opacity:G||b?1:R,transition:b||L||G?"none":"opacity 2s linear 1s"}})})]})}},665290:function(e,t,n){n.d(t,{Ii:()=>i,VI:()=>o,We:()=>a,eZ:()=>r,iF:()=>s});let i="stela-cutout",a="cutout-fade",o=2e3,r=300,s=`
  .${a}-appear {
    opacity: 0;
  }
  .${a}-appear-active {
    opacity: 1;
    transition: opacity ${o}ms;
  }
  .${a}-appear-done {
    opacity: 1;
  }

  .${a}-enter {
    opacity: 0;
  }
  .${a}-enter-active {
    opacity: 1;
    transition: opacity ${r}ms;
  }
  .${a}-enter-done {
    opacity: 1;
  }

  .${a}-exit {
    opacity: 1;
  }
  .${a}-exit-active {
    opacity: 0;
    transition: opacity ${r}ms;
  }
  .${a}-exit-done {
    opacity: 0;
  }
`},281503:function(e,t,n){n.d(t,{Z:()=>a});var i=n(785893);function a({blurIntensity:e=.1,debugMode:t=!1,insetIntensity:n=2,kind:a,maskHeight:o,maskId:r,maskUrl:s,maskWidth:l,maxBlurLength:u=100}){let c=`${a}-${r}`,h=`insetBlurFilter-${c}`,d=`originalMask-${c}`,p=`featheredMask-${c}`,f=Math.min(u,Math.round(Math.min(l,o)))*e;return{svgElement:(0,i.jsxs)("svg",{"data-gestalt-valid-html":"Image",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:[(0,i.jsxs)("defs",{children:[(0,i.jsxs)("filter",{id:h,children:[(0,i.jsx)("feGaussianBlur",{edgeMode:"none",stdDeviation:f}),(0,i.jsx)("feComponentTransfer",{children:(0,i.jsx)("feFuncA",{amplitude:"1",exponent:n,offset:"0",type:"gamma"})})]}),(0,i.jsx)("mask",{id:d,children:(0,i.jsx)("image",{height:o,href:s,id:`${d}-image`,width:l})}),(0,i.jsx)("use",{href:`#${d}-image`,id:`${d}-white`,mask:`url(#${d})`}),(0,i.jsx)("mask",{id:p,children:(0,i.jsx)("use",{filter:`url(#${h})`,href:`#${d}-white`,mask:`url(#${d})`})})]}),t&&(0,i.jsx)("rect",{fill:"green",height:o,mask:`url(#${p})`,width:l,x:"0",y:"0"})]}),maskStyle:{mask:`url(#${p})`}}}},814685:function(e,t,n){n.d(t,{$V:()=>a,M:()=>i,Qs:()=>l,nn:()=>o,qN:()=>s,tX:()=>r});let i=520,a=6,o=16,r=4,s=2,l=6}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/49793.en_GB-143ace2a7bfcc09a.mjs.map